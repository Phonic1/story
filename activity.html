<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Safe Story Adventure</title>
    <style>
        /* --- STYLES FOR THE LIVE APPLICATION --- */
        :root {
            --color-accent: #007aff;
            --color-correct: #34c759;
            --color-incorrect: #ff3b30;
            --color-text: #333;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --btn-border-radius: 20px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: "Comic Sans MS", cursive, sans-serif;
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            color: var(--color-text);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 100%; max-width: 1000px; background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px; box-shadow: var(--shadow); overflow: hidden;
            display: flex; flex-direction: column;
        }
        .header {
            background-color: #9c27b0; color: white; padding: 20px 30px; text-align: center;
            border-bottom: 5px solid #7b1fa2;
        }
        .header h1 { font-size: 2.5rem; font-weight: bold; margin-bottom: 10px; }
        #student-name-input {
            padding: 8px 12px; font-size: 1rem; font-family: inherit;
            border-radius: 8px; border: 1px solid #ccc; width: 100%;
            max-width: 400px; text-align: center;
        }
        #student-name-input::placeholder { color: #666; }

        .nav-bar { display: flex; justify-content: center; background-color: #e1bee7; padding: 10px; }
        .nav-button {
            background-color: #1e90ff; color: white; border: 3px solid white;
            border-radius: var(--btn-border-radius); padding: 10px 25px; font-family: inherit; font-size: 1.2rem;
            font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: transform 0.2s ease-in-out, background-color 0.2s ease; 
            margin: 0 10px;
        }
        .nav-button:hover { transform: scale(1.1); }
        .nav-button.active { background-color: #ff4500; transform: scale(1.05); }

        .content-area { padding: 30px; }
        .section { display: none; animation: fadeIn 0.5s ease-in-out; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 { color: #9c27b0; font-size: 2rem; margin-bottom: 20px; text-align: center; }
        p { line-height: 1.6; margin-bottom: 15px; font-size: 1.1rem; }
        
        .btn {
            color: white; border: 3px solid white; border-radius: var(--btn-border-radius);
            padding: 10px 25px; font-family: inherit; font-size: 1.2rem; font-weight: bold;
            cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: transform 0.2s ease-in-out;
        }
        .btn:hover { transform: scale(1.1); }
        .section-footer { margin-top: 30px; text-align: center; display: flex; justify-content: center; gap: 15px; }
        .btn-main { background-color: #32cd32; }
        .btn-secondary { background-color: #1e90ff; }
        .btn-accent { background-color: #ffc107; } /* NEW YELLOW BUTTON STYLE */

        /* --- PAST & FUTURE SECTIONS --- */
        .prompt-card-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .prompt-card {
            background-color: #f3e5f5; border-left: 5px solid var(--color-accent);
            padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .prompt-card h3 { color: #9c27b0; margin-bottom: 10px; }
        
        .flip-card-container { display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px; margin: 30px 0; }
        .flip-card { background-color: transparent; width: 150px; height: 150px; perspective: 1000px; cursor: pointer; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .flip-card.is-flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back {
            position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden;
            border-radius: 15px; box-shadow: var(--shadow); display: flex; justify-content: center; align-items: center; text-align: center;
            font-size: 1.2rem; font-weight: 700; color: white; padding: 10px;
        }
        .flip-card-front { background-color: #ff4500; font-size: 4rem; }
        .flip-card-back { background-color: #32cd32; transform: rotateY(180deg); }
        
        .extra-question {
            background-color: #9c27b0; color: white; border-radius: var(--border-radius);
            padding: 15px; text-align: center; margin: 20px auto 0 auto; max-width: 500px;
            opacity: 0; transform: translateY(20px); transition: all 0.5s ease-in-out 0.3s;
        }
        .extra-question.visible { opacity: 1; transform: translateY(0); }

        .pledge-section { margin-top: 30px; text-align: center; }
        .pledge-input-area { display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 15px; }
        .pledge-input {
            flex-grow: 1; padding: 12px; border: 2px solid #ccc;
            border-radius: 10px; font-family: inherit; font-size: 1rem;
            color: var(--color-text);
        }
        #add-pledge-btn { background-color: #1e90ff; }
        .pledge-wall { margin-top: 25px; padding: 20px; min-height: 200px; background-color: #fffbe6; border: 2px solid #ffe8a8; border-radius: 10px; display: flex; flex-wrap: wrap; gap: 15px; align-content: flex-start; }
        .pledge-note { width: 180px; height: 180px; padding: 15px; box-shadow: 5px 5px 10px rgba(0,0,0,0.1); font-family: inherit; font-size: 1rem; display: flex; justify-content: center; align-items: center; text-align: center; transition: transform 0.2s; }

        /* --- PRESENT SECTION (SORTING GAME) --- */
        #present .controls { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-bottom: 20px; }
        #present #reset-btn { background-color: #32cd32; }
        #present #check-btn { background-color: #1e90ff; }
        #present #pdf-btn { background-color: #ff4500; }
        .drop-zones {
            display: grid; grid-template-columns: 1fr 1fr;
            gap: 20px; width: 100%;
            align-items: start;
        }
        .drop-box { background: rgba(255, 255, 255, 0.85); border: 2px dashed #ccc; border-radius: var(--border-radius); padding: 20px; min-height: 350px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .box-image-container { width: 100%; height: 120px; background-color: #f3e5f5; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px; }
        .box-image-container img { height: 100%; width: 100%; object-fit: cover; border-radius: 8px; }
        .box-header { font-size: 1.25rem; font-weight: bold; }
        #tile-container { height: 180px; display: flex; align-items: center; justify-content: center; }
        .tile { background: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow); text-align: center; font-size: 1.2rem; line-height: 1.5; cursor: grab; transition: all 0.3s ease; user-select: none; position: relative; border: 2px solid transparent; }
        .tile.current-tile { min-width: 80%; max-width: 500px; min-height: 120px; display: flex; align-items: center; justify-content: center; transform: scale(1.1); border-color: #007aff; }
        .drop-box .tile { font-size: 1rem; width: 95%; padding: 10px; margin-bottom: 5px; }
        .tile.correct { border-color: var(--color-correct); }
        .tile.incorrect { border-color: var(--color-incorrect); }
        .read-aloud-btn { position: absolute; bottom: 10px; right: 10px; width: 36px; height: 36px; background-color: #f0f0f0; border: 1px solid #ddd; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; }

        /* --- PRINT STYLES --- */
        .print-only, .print-only-pledge { display: none; }
        @media print {
            @page { margin: 1cm; size: A4 portrait; }
            body { background: none; color: black; font-size: 10pt; }
            .container { display: none; }
            
            .print-worksheet-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; }
            .print-worksheet-header .title-block h1 { font-size: 24pt; color: #6a0dad; margin-bottom: 5px; line-height: 1.1; }
            .print-worksheet-header .info-block { text-align: right; font-size: 10pt; white-space: nowrap; }
            #print-date, #print-pledge-date { margin-bottom: 5px; }

            .print-sorting-boxes { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75cm; }
            .print-box { border: 2px dashed #999; border-radius: 15px; padding: 10px; text-align: center; min-height: 200px; page-break-inside: avoid; }
            .print-box h2 { font-size: 16pt; margin-bottom: 10px; color: black; }
            .print-box img { max-width: 100%; height: 80px; object-fit: contain; margin-bottom: 10px; }
            .print-tile { border: 1.5px solid #888; border-radius: 8px; padding: 8px; text-align: center; font-size: 10pt; line-height: 1.3; margin: 5px auto; width: 95%; background-color: #fff; }
            .print-tile.correct { background-color: #e6ffed; border-color: #5cb85c; }
            .print-tile.incorrect { background-color: #ffebee; border-color: #d9534f; }
            
            #print-pledge-wall { page-break-inside: avoid; margin-top: 20px; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
            .print-pledge-note {
                width: 150px; height: 150px; padding: 10px; border: 1px solid #ccc;
                box-shadow: 3px 3px 5px rgba(0,0,0,0.1); font-size: 9pt; display: flex;
                justify-content: center; align-items: center; text-align: center; line-height: 1.3;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    
    <div class="print-only" id="print-sorting-worksheet">
        <header class="print-worksheet-header">
            <div class="title-block"><h1>Friend Sorting Activity</h1></div>
            <div class="info-block"><div id="print-date"></div><div id="print-student-name"></div></div>
        </header>
        <main>
            <div class="print-sorting-boxes">
                <div class="print-box">
                    <img src="in-person-friend.jpg" alt="In-person Friends">
                    <h2>In-person Friend</h2><div id="print-in-person-box-content"></div>
                </div>
                <div class="print-box">
                    <img src="online-friend.jpg" alt="Online Friend">
                    <h2>Online Friend</h2><div id="print-online-box-content"></div>
                </div>
            </div>
        </main>
    </div>

    <div class="print-only-pledge" id="print-pledge-worksheet">
        <header class="print-worksheet-header">
            <div class="title-block"><h1>My Cyber Safe Pledge Wall</h1></div>
            <div class="info-block"><div id="print-pledge-date"></div><div id="print-pledge-student-name"></div></div>
        </header>
        <main><div id="print-pledge-wall"></div></main>
    </div>

    <div class="container">
        <header class="header">
            <h1>Cyber Safe Story Adventure</h1>
            <div class="name-input-container">
                <input type="text" id="student-name-input" placeholder="Enter your name for the worksheet...">
            </div>
        </header>

        <nav class="nav-bar">
            <button class="nav-button active" data-section="past">1. The Past</button>
            <button class="nav-button" data-section="present">2. The Present</button>
            <button class="nav-button" data-section="future">3. The Future</button>
        </nav>

        <main class="content-area">
            <section id="past" class="section active">
                <h2>Part 1: The Past - What happened?</h2>
                <div class="prompt-card-container">
                    <div class="prompt-card"><h3>Let's Talk About Jack</h3><p>What happened to Jack in the story? Why did he feel worried when talking to 'Footy Boy'?</p></div>
                    <div class="prompt-card"><h3>Talking in Games</h3><p>Jack plays online games. Do you ever talk to other players during an online game?</p></div>
                    <div class="prompt-card"><h3>Personal Questions</h3><p>Has an online friend ever asked you questions about your school, where you live, or your age?</p></div>
                    <div class="prompt-card"><h3>Your Story</h3><p>Has anything like Jack's story ever happened to you or someone you know?</p></div>
                </div>
                <div class="section-footer"><button class="btn btn-main" onclick="showSection('present')">Time for an Activity!</button></div>
            </section>

            <section id="present" class="section">
                <h2>Part 2: The Present - Friend Sorting!</h2>
                <p>Let's practice telling the difference between an in-person friend and an online friend. Sort the cards into the correct box!</p>
                <div class="controls">
                    <button id="reset-btn" class="btn">Reset Game</button>
                    <button id="check-btn" class="btn">Check Answers</button>
                    <button id="pdf-btn" class="btn">Save as Worksheet</button>
                    <button class="btn btn-accent" onclick="showSection('future')">Let's Plan for the Future!</button>
                </div>
                <div class="drop-zones">
                    <div id="in-person-box" class="drop-box" data-category="in-person">
                        <div class="box-image-container"><img src="in-person-friend.jpg" alt="In-person friends"></div>
                        <div class="box-header">In-person Friend <span class="count" id="in-person-count">(0)</span></div>
                    </div>
                    <div id="online-box" class="drop-box" data-category="online">
                        <div class="box-image-container"><img src="online-friend.jpg" alt="Online friend avatar"></div>
                        <div class="box-header">Online Friend <span class="count" id="online-count">(0)</span></div>
                    </div>
                </div>
                <div id="tile-container"></div>
            </section>

            <section id="future" class="section">
                <h2>Part 3: The Future - What will we do?</h2>
                <p>Planning what to do is the best way to stay safe! If something like Jack's story happens, it's important to know who can help.</p>
                <h3>Who are our trusted adults?</h3>
                <div class="flip-card-container">
                    <div class="flip-card"><div class="flip-card-inner"><div class="flip-card-front">?</div><div class="flip-card-back">Parents / Carers</div></div></div>
                    <div class="flip-card"><div class="flip-card-inner"><div class="flip-card-front">?</div><div class="flip-card-back">Teacher</div></div></div>
                    <div class="flip-card"><div class="flip-card-inner"><div class="flip-card-front">?</div><div class="flip-card-back">Grandparents</div></div></div>
                    <div class="flip-card" id="police-officer-card"><div class="flip-card-inner"><div class="flip-card-front">?</div><div class="flip-card-back">Police Officer</div></div></div>
                </div>
                <p class="extra-question" id="extra-question-prompt">Can you think of any more trusted adults?</p>

                <div class="pledge-section">
                    <h3>Create a Cyber Safe Pledge Wall!</h3>
                    <p>Let's make a promise to stay safe online. Finish the sentence below and add your pledge to our class wall.</p>
                    <div class="pledge-input-area">
                        <span>I will stay safe online by...</span>
                        <input type="text" id="pledge-input" class="pledge-input" placeholder="...not sharing my address." maxlength="100">
                        <button id="add-pledge-btn" class="btn">Add to Wall!</button>
                    </div>
                    <div id="pledge-wall" class="pledge-wall"></div>
                </div>
                <div class="section-footer">
                    <button id="save-pledge-btn" class="btn btn-secondary">Save as Worksheet</button>
                    <button class="btn btn-main" onclick="showSection('past')">Start Over</button>
                </div>
            </section>
        </main>
    </div>

<script>
    // --- GLOBAL DATA & UTILITIES ---
    const sentences = [ { text: "We sit next to each other in class.", category: "in-person" }, { text: "I see them on the playground at recess.", category: "in-person" }, { text: "We walk home from school together.", category: "in-person" }, { text: "My teacher knows who they are.", category: "in-person" }, { text: "I have been to their house for a playdate.", category: "in-person" }, { text: "I only know them by their username.", category: "online" }, { text: "They use a cartoon picture instead of their real photo.", category: "online" }, { text: "I met them while playing a game online.", category: "online" }, { text: "We only talk through messages on an app.", category: "online" }, { text: "They asked me what school I go to.", category: "online" } ];
    const shuffleArray = (array) => { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1));[array[i], array[j]] = [array[j], array[i]]; } };

    // --- CORE NAVIGATION LOGIC ---
    const navButtons = document.querySelectorAll('.nav-button');
    const sections = document.querySelectorAll('.section');
    function showSection(sectionId) {
        sections.forEach(section => section.classList.remove('active'));
        document.getElementById(sectionId)?.classList.add('active');
        navButtons.forEach(button => {
            button.classList.toggle('active', button.dataset.section === sectionId);
        });
        if (sectionId === 'present') {
            startGame();
        } else if (sectionId === 'future') {
            document.querySelectorAll('.flip-card').forEach(card => card.classList.remove('is-flipped'));
            document.getElementById('extra-question-prompt').classList.remove('visible');
        }
    }
    navButtons.forEach(button => button.addEventListener('click', () => showSection(button.dataset.section)));

    // --- FRIEND SORTING GAME LOGIC ---
    const inPersonBox = document.getElementById('in-person-box');
    const onlineBox = document.getElementById('online-box');
    const tileContainer = document.getElementById('tile-container');
    const resetBtn = document.getElementById('reset-btn');
    const checkBtn = document.getElementById('check-btn');
    const pdfBtn = document.getElementById('pdf-btn');
    const studentNameInput = document.getElementById('student-name-input');
    let currentSentences = [];
    let currentIndex = 0;
    let draggedTile = null;

    const synth = window.speechSynthesis;
    const speakText = (text) => {
        if (!synth) return;
        if (synth.speaking) synth.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        synth.speak(utterance);
    };

    const startGame = () => {
        if (synth && synth.speaking) synth.cancel();
        currentIndex = 0;
        currentSentences = [...sentences];
        shuffleArray(currentSentences);
        checkBtn.classList.remove('highlight-check');
        document.querySelectorAll('.drop-box .tile').forEach(tile => tile.remove());
        showNextTile();
        updateCounts();
    };

    const showNextTile = () => {
        tileContainer.innerHTML = '';
        if (currentIndex >= currentSentences.length) {
            checkBtn.classList.add('highlight-check');
            checkBtn.focus();
            return;
        }
        const sentence = currentSentences[currentIndex];
        const tile = document.createElement('div');
        tile.className = 'tile current-tile';
        tile.draggable = true;
        tile.dataset.category = sentence.category;
        tile.innerHTML = `<span>${sentence.text}</span><button class="read-aloud-btn" aria-label="Read sentence aloud"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="#555"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg></button>`;
        tile.querySelector('.read-aloud-btn').addEventListener('click', (e) => { e.stopPropagation(); speakText(sentence.text); });
        addTileEventListeners(tile);
        tileContainer.appendChild(tile);
    };
    
    const moveTileToBox = (tile, targetBox) => {
        if (!tile || !targetBox) return;
        if (synth && synth.speaking) synth.cancel();
        tile.classList.remove('current-tile', 'correct', 'incorrect');
        tile.querySelector('.read-aloud-btn')?.remove();
        targetBox.appendChild(tile);
        updateCounts();
        currentIndex++;
        showNextTile();
    };

    const updateCounts = () => {
        document.getElementById('in-person-count').textContent = `(${inPersonBox.querySelectorAll('.tile').length})`;
        document.getElementById('online-count').textContent = `(${onlineBox.querySelectorAll('.tile').length})`;
    };
    
    const checkAllAnswers = () => {
        let correctCount = 0;
        const allSortedTiles = document.querySelectorAll('.drop-box .tile');
        if (allSortedTiles.length === 0) { alert('Sort some tiles first!'); return; }
        allSortedTiles.forEach(tile => {
            const isCorrect = tile.parentElement.dataset.category === tile.dataset.category;
            tile.classList.toggle('correct', isCorrect);
            tile.classList.toggle('incorrect', !isCorrect);
            if (isCorrect) correctCount++;
        });
        alert(`You got ${correctCount} out of ${allSortedTiles.length} correct so far.`);
    };

    function addTileEventListeners(tile) {
        tile.addEventListener('dragstart', (e) => { draggedTile = e.target; });
        tile.addEventListener('dragend', () => { draggedTile = null; });
    }
    [inPersonBox, onlineBox].forEach(box => {
        box.addEventListener('click', () => { const ct = document.querySelector('.current-tile'); if(ct) moveTileToBox(ct, box); });
        box.addEventListener('dragover', (e) => e.preventDefault());
        box.addEventListener('drop', (e) => {
            e.preventDefault();
            if (draggedTile) moveTileToBox(draggedTile, box);
        });
    });
    
    resetBtn.addEventListener('click', startGame);
    checkBtn.addEventListener('click', checkAllAnswers);
    
    pdfBtn.addEventListener('click', () => {
        document.getElementById('print-student-name').textContent = `Name: ${studentNameInput.value.trim() || '____________________'}`;
        document.getElementById('print-date').textContent = `Date: ${new Date().toLocaleDateString()}`;

        const printInPersonContainer = document.getElementById('print-in-person-box-content');
        const printOnlineContainer = document.getElementById('print-online-box-content');
        printInPersonContainer.innerHTML = '';
        printOnlineContainer.innerHTML = '';

        document.querySelectorAll('#in-person-box .tile').forEach(liveTile => {
            const printTile = document.createElement('div');
            printTile.className = 'print-tile';
            if (liveTile.classList.contains('correct')) printTile.classList.add('correct');
            if (liveTile.classList.contains('incorrect')) printTile.classList.add('incorrect');
            printTile.textContent = liveTile.querySelector('span').textContent;
            printInPersonContainer.appendChild(printTile);
        });
        document.querySelectorAll('#online-box .tile').forEach(liveTile => {
            const printTile = document.createElement('div');
            printTile.className = 'print-tile';
            if (liveTile.classList.contains('correct')) printTile.classList.add('correct');
            if (liveTile.classList.contains('incorrect')) printTile.classList.add('incorrect');
            printTile.textContent = liveTile.querySelector('span').textContent;
            printOnlineContainer.appendChild(printTile);
        });
        
        document.getElementById('print-pledge-worksheet').style.display = 'none';
        document.getElementById('print-sorting-worksheet').style.display = 'block';
        window.print();
        document.getElementById('print-pledge-worksheet').style.display = '';
        document.getElementById('print-sorting-worksheet').style.display = '';
    });

    // --- FUTURE PAGE LOGIC ---
    const policeCard = document.getElementById('police-officer-card');
    const extraQuestionPrompt = document.getElementById('extra-question-prompt');
    document.querySelectorAll('.flip-card').forEach(card => {
        card.addEventListener('click', () => {
            card.classList.toggle('is-flipped');
        });
    });
    policeCard.addEventListener('click', () => {
        setTimeout(() => {
            extraQuestionPrompt.classList.add('visible');
        }, 100);
    });

    const addPledgeBtn = document.getElementById('add-pledge-btn');
    const pledgeInput = document.getElementById('pledge-input');
    const pledgeWall = document.getElementById('pledge-wall');
    const noteColors = ['#fdffb6', '#ffc6d9', '#a0c4ff', '#caffbf'];
    let pledgeNoteColorIndex = 0;

    function addPledge() {
        const pledgeText = pledgeInput.value.trim();
        if (pledgeText === "") { alert("Please write your pledge first!"); return; }
        const note = document.createElement('div');
        note.className = 'pledge-note';
        note.textContent = "I will stay safe online by " + pledgeText;
        note.style.backgroundColor = noteColors[pledgeNoteColorIndex];
        pledgeNoteColorIndex = (pledgeNoteColorIndex + 1) % noteColors.length;
        note.style.transform = `rotate(${(Math.random() * 8) - 4}deg)`;
        pledgeWall.appendChild(note);
        pledgeInput.value = "";
        pledgeInput.focus();
    }
    addPledgeBtn.addEventListener('click', addPledge);
    pledgeInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') addPledge(); });

    document.getElementById('save-pledge-btn').addEventListener('click', () => {
        document.getElementById('print-pledge-student-name').textContent = `Name: ${studentNameInput.value.trim() || '____________________'}`;
        document.getElementById('print-pledge-date').textContent = `Date: ${new Date().toLocaleDateString()}`;

        const printPledgeWall = document.getElementById('print-pledge-wall');
        printPledgeWall.innerHTML = '';
        document.querySelectorAll('#pledge-wall .pledge-note').forEach(liveNote => {
            const printNote = document.createElement('div');
            printNote.className = 'print-pledge-note';
            printNote.textContent = liveNote.textContent;
            printNote.style.backgroundColor = liveNote.style.backgroundColor;
            printNote.style.transform = liveNote.style.transform;
            printPledgeWall.appendChild(printNote);
        });

        document.getElementById('print-sorting-worksheet').style.display = 'none';
        document.getElementById('print-pledge-worksheet').style.display = 'block';
        window.print();
        document.getElementById('print-sorting-worksheet').style.display = '';
        document.getElementById('print-pledge-worksheet').style.display = '';
    });

    // --- INITIALIZE THE APP ---
    document.addEventListener('DOMContentLoaded', () => {
        showSection('past');
    });
</script>
</body>
</html>